package vulnerabilities;

import report.ReportInformation;
import service.MongoService;
import vulnerabilities.rule.Rule;

import java.util.ArrayList;
import java.util.List;

public abstract class Vulnerability {

    private final MongoService mongoService = new MongoService();

    public abstract List<ReportInformation> checkRules(List<String> sourceCode);

    public List<Rule> initializeRules(Object object) {
        String vulnerabilityName = object.getClass().getSimpleName();

        List<Rule> result = new ArrayList<>();
        Rule strcpyRule = new Rule("Using strcpy function", "strcpy"
                , "Unsafe fuction strcpy", "Better use strncpy");
        Rule strcatRule = new Rule("Using strcat function", "strcat"
                , "Unsafe function strcat", "Better use strncat");
        Rule gets = new Rule("Unsafe function gets", "gets"
                , "Unsafe function gets", "Better use fgets");
        result.add(strcpyRule);
        result.add(strcatRule);
        result.add(gets);
        return result;
    }
}
