import utils.InputParametersPattern;
import utils.ParametersParser;

import java.nio.file.FileSystems;
import java.util.Arrays;
import java.util.Map;

public class VulnerabilityAnalyzerToolClient {

    public static void main(String[] args) {
        Map<InputParametersPattern, String> parameters = ParametersParser.parseInputParameters(args);
        String sourceCodeAbsolutePath = FileSystems.getDefault()
                .getPath(parameters.get(InputParametersPattern.SOURCE_CODE_PATH))
                .normalize().toAbsolutePath().toString();
        String reportFolderAbsolutePath = FileSystems.getDefault()
                .getPath(parameters.get(InputParametersPattern.REPORT_FOLDER_PATH))
                .normalize().toAbsolutePath().toString();
        VulnerabilityAnalyzerLauncher launcher = new VulnerabilityAnalyzerLauncher(
                Arrays.stream(parameters.get(InputParametersPattern.VULNERABILITIES_LIST).split(", ")).toList()
                , sourceCodeAbsolutePath
                , reportFolderAbsolutePath);
        launcher.execute();
    }
}
